<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin - Manage Categories</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; background:#f5f6fa; padding:30px; color:#333; }
h1 { margin-bottom:20px; color:#007bff; }

form { background:#fff; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.08); margin-bottom:30px; }
form label { display:block; margin-top:10px; font-weight:bold; }
form input, form select { width:100%; padding:10px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
form button { margin-top:15px; padding:10px 15px; border:none; border-radius:5px; background:#007bff; color:white; cursor:pointer; }
form button:hover { background:#0056b3; }

table { width:100%; border-collapse: collapse; background:#fff; border-radius:8px; overflow:hidden; box-shadow:0 0 10px rgba(0,0,0,0.08); }
th, td { padding:12px 15px; text-align:left; border-bottom:1px solid #eee; }
th { background:#007bff; color:white; }
tr:hover { background:#f1f1f1; }

.actions button, .actions a { padding:6px 10px; border:none; border-radius:4px; cursor:pointer; font-size:13px; margin-right:5px; text-decoration:none; }
.edit { background:#ffc107; color:#000; }
.edit:hover { background:#e0a800; }
.delete { background:#dc3545; color:white; }
.delete:hover { background:#c82333; }

.msg { padding:10px 15px; border-radius:5px; margin-bottom:15px; }
.success { background:#d4edda; color:#155724; }
.danger { background:#f8d7da; color:#721c24; }
.warning { background:#fff3cd; color:#856404; }
</style>
</head>
<body>

<h1>Manage Categories</h1>

<div class="nav">
    <a href="{{ url_for('manage_videos') }}">üì∫ Videos</a>
    <a href="{{ url_for('manage_categories') }}">üìÅ Categories</a>
   <a href="{{ url_for('logout') }}">Logout</a>
</div>

<!-- Flash messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="msg {{ category }}">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<!-- Add New Category Form -->
<h2>Add New Category</h2>
<form method="POST" action="{{ url_for('manage_categories') }}">
    <label>Category Name</label>
    <input type="text" name="name" placeholder="Category Name" required>

    <label>Parent Category (Optional)</label>
    <select name="parent_id">
        <option value="">-- No Parent --</option>
        {% for cat in categories %}
            <option value="{{ cat.id }}">{{ cat.name }}</option>
        {% endfor %}
    </select>

    <button type="submit">Add Category</button>
</form>

<!-- Existing Categories Table -->
<h2>Existing Categories</h2>
<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>Parent</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for cat in categories %}
        <tr>
            <td>{{ cat.name }}</td>
            <td>{{ cat.parent.name if cat.parent else "None" }}</td>
            <td class="actions">
                <!-- EDIT -->
                <a class="edit" href="{{ url_for('edit_category', category_id=cat.id) }}">Edit</a>

                <!-- DELETE -->
                <form method="POST" action="{{ url_for('delete_category', category_id=cat.id) }}" style="display:inline;" onsubmit="return confirm('Delete this category?');">
                    <button type="submit" class="delete">Delete</button>
                </form>
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>

</body>
</html>
