<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin - Manage Videos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* ===== GENERAL ===== */
        * { box-sizing: border-box; margin:0; padding:0; }
        body { font-family: 'Roboto', sans-serif; background:#0f172a; color:#e5e7eb; }
        a { text-decoration:none; color:inherit; }

        /* ===== HEADER ===== */
        header { background:#1e293b; padding:20px; display:flex; justify-content:space-between; align-items:center; }
        header h1 { font-size:22px; color:#22c55e; }
        header a { background:#22c55e; color:#0f172a; padding:8px 16px; border-radius:6px; font-weight:500; margin-left:10px; transition: background 0.2s; }
        header a:hover { background:#16a34a; }

        /* ===== MAIN ===== */
        main { padding:30px; max-width: 1000px; margin:auto; }

        h2 { margin-bottom:20px; font-size:20px; color:#22c55e; }

        /* ===== TABLE ===== */
        table { width:100%; border-collapse:collapse; background:#1e293b; border-radius:10px; overflow:hidden; box-shadow:0 8px 20px rgba(0,0,0,0.4); margin-top:30px; }
        th, td { padding:12px 15px; text-align:left; }
        th { background:#334155; font-weight:500; color:#e5e7eb; }
        tr { border-bottom:1px solid #334155; }
        tr:last-child { border-bottom:none; }
        td { color:#cbd5e1; }

        /* ===== ACTION BUTTONS ===== */
        .btn { padding:6px 12px; border:none; border-radius:6px; font-weight:500; cursor:pointer; transition:0.2s; text-decoration:none; color:#0f172a; }
        .btn-edit { background:#22c55e; }
        .btn-edit:hover { background:#16a34a; }
        .btn-delete { background:#ef4444; }
        .btn-delete:hover { background:#b91c1c; }

        /* ===== FLASH MESSAGES ===== */
        .msg { margin-top:15px; padding:12px; border-radius:6px; font-weight:500; }
        .success { background:#d1fae5; color:#065f46; }
        .danger { background:#fca5a5; color:#991b1b; }

        /* ===== FORM ===== */
        .video-form { background:#1e293b; padding:20px; border-radius:10px; box-shadow:0 8px 20px rgba(0,0,0,0.4); margin-bottom:30px; }
        .video-form label { display:block; margin-top:10px; font-weight:500; color:#22c55e; }
        .video-form input, .video-form select, .video-form textarea { width:100%; padding:10px; margin-top:5px; border-radius:6px; border:1px solid #334155; background:#0f172a; color:#e5e7eb; }
        .video-form button { margin-top:15px; padding:10px 15px; border:none; border-radius:6px; background:#22c55e; color:#0f172a; font-weight:500; cursor:pointer; }
        .video-form button:hover { background:#16a34a; }

        /* ===== NAVIGATION ===== */
        .nav { margin-bottom:20px; display:flex; gap:15px; flex-wrap:wrap; }
        .nav a { color:#22c55e; font-weight:500; transition: color 0.2s; }
        .nav a:hover { color:#16a34a; }

        /* ===== RESPONSIVE ===== */
        @media (max-width:768px){
            th, td { padding:10px; font-size:14px; }
            main { padding:20px; }
        }
        @media (max-width:480px){
            table, thead, tbody, th, td, tr { display:block; }
            th { display:none; }
            tr { margin-bottom:15px; }
            td { padding-left:50%; position:relative; }
            td::before { 
                content: attr(data-label); 
                position:absolute; 
                left:15px; 
                font-weight:500; 
                color:#22c55e; 
            }
        }
    </style>
</head>
<body>

<header>
    <h1>üì∫ Manage Videos</h1>
    <div>
        <a href="{{ url_for('admin_dashboard') }}">üè† Dashboard</a>
        <a href="{{ url_for('admin_logout') }}">Logout</a>
    </div>
</header>

<main>
    <h2>Add New Video</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="msg {{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form class="video-form" method="POST" action="{{ url_for('manage_videos') }}">
        <label>Video Title:</label>
        <input type="text" name="title" placeholder="Enter video title" required>

        <label>Description:</label>
        <textarea name="description" rows="3" placeholder="Enter description"></textarea>

        <label>Category:</label>
        <select name="category_id">
            <option value="">-- Select Category --</option>
            {% for cat in categories %}
                <option value="{{ cat.id }}">{{ cat.name }}</option>
            {% endfor %}
        </select>

        <label>YouTube Embed Link:</label>
        <input type="text" name="youtube_link" placeholder="Paste YouTube embed link" required>

        <label>Google Drive Link (Agasobanuye):</label>
        <input type="text" name="drive_link" placeholder="Paste Google Drive link">

        <label>MediaFire Download Link:</label>
        <input type="text" name="mediafire_link" placeholder="Paste MediaFire link">

        <button type="submit">Add Video</button>
    </form>

    <h2>All Videos</h2>
    <div class="nav">
        <a href="{{ url_for('admin_dashboard') }}">‚¨Ö Back to Dashboard</a>
    </div>

    {% if videos %}
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Video ID</th>
                    <th>Category</th>
                    <th>Views</th>
                    <th>Date Added</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for video in videos %}
                    <tr>
                        <td data-label="ID">{{ video.id }}</td>
                        <td data-label="Title">{{ video.title }}</td>
                        <td data-label="Video ID">{{ video.video_id }}</td>
                        <td data-label="Category">{{ video.category.name if video.category else 'None' }}</td>
                        <td data-label="Views">{{ video.views }}</td>
                        <td data-label="Date Added">{{ video.date_added.strftime('%Y-%m-%d') }}</td>
                        <td data-label="Actions">
                            <a href="{{ url_for('edit_video', video_id=video.id) }}" class="btn btn-edit">Edit</a>
                            <a href="{{ url_for('delete_video', video_id=video.id) }}" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this video?');">Delete</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No videos found. <a href="{{ url_for('add_video_view') }}">Add a new video</a>.</p>
    {% endif %}
</main>
</body>
</html>